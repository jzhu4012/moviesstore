{% extends "base.html" %}

{% block content %}
<div class="max-w-4xl mx-auto my-8 px-4">
    <h2 class="text-2xl font-bold mb-4">{{ template_data.title }}</h2>

    {% if user.is_authenticated %}
        <a href="{% url 'movies.create_petition' %}"
           class="inline-block mb-6 px-4 py-2 bg-blue-600 text-black rounded hover:bg-blue-700">
            Create Petition
        </a>
    {% else %}
        <p class="mb-6">You must <a href="{% url 'accounts.login' %}" class="text-blue-600 underline">log in</a> to
            create a petition.</p>
    {% endif %}

    {% if template_data.petitions %}
        <ul class="space-y-4">
            {% for petition in template_data.petitions %}
                <li class="p-4 bg-white shadow rounded flex justify-between items-center">
                    <div>
                        <a href="{% url 'movies.petition' petition.pk %}"
                           class="text-lg font-semibold text-blue-700 hover:underline">
                            {{ petition.title }}
                        </a>
                        <p class="text-sm text-gray-500">
                            Created on {{ petition.created_at|date:"M d, Y" }}
                        </p>
                    </div>
                    <div class="text-right">
                        <p class="text-sm">Votes: {{ petition.vote_count }}</p>
                        <p class="text-xs italic">Status: {{ petition.status }}</p>
                    </div>
                </li>
            {% endfor %}
        </ul>
    {% else %}
        <p>No petitions yet. Be the first to <a href="{% url 'movies.create_petition' %}"
                                                class="text-blue-600 underline">create one</a></p>
    {% endif %}
</div>
{% endblock %}